<!DOCTYPE html>
<html>
	<head>
		<title>Page Title</title>
		<meta name = "viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="css/one.css" />
		<link rel="stylesheet" href="css/index.css" />
		<script src="jquery-1.11.2.min.js"></script>
		<script src="js/a.js"></script>
		<script src="js/b.js"></script>
		<link rel="stylesheet" href="css/peptheme.css">
		<script src="js/global.js"></script>
	</head>
	<body>
		<div data-role="page" data-theme="a" id="index">


			<div data-role="panel" id="mypanel">
				<ul data-role="listview" data-inset="true" style="min-width:210px;">
					<li><a href="search.html" class="ui-icon-search" data-ajax="false">Search</a></li>
					<li><a href="browse.html" class="ui-icon-grid" data-ajax="false">Browse</a></li>
					<li><a href="options.html" class="ui-icon-gear" data-ajax="false">Options</a></li>
					<li><a href="index.html" data-ajax="false">Temp: Splash</a></li>
					<li><a href="first.html" data-ajax="false">Temp: First</a></li>
				</ul>
				<a href="#my-header" data-rel="close" class="ui-btn ui-corner-all ui-shadow ui-icon-delete ui-btn-icon-right ui-btn-a">Close panel</a>
			</div><!-- /panel -->
			<div data-role="header" id="my-header" data-theme="a" data-position="fixed">
				<a href="#mypanel" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-icon-bars ui-btn-icon-left ui-btn-a menu">menu</a>
				<!-- <h1>Buoy</h1> -->
				<img src="images/buoy-white.gif" alt="Buoy" style="height:50px;display:block;margin-left:auto;margin-right:auto;margin-bottom:4px;" />
				<a href="home.html" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-icon-home ui-btn-icon-right ui-btn-a menu" data-ajax="false">home</a>
			</div> <!-- /header -->

			
			<div data-role="content">
				<form class="ui-filterable">
					<input id="autocomplete-input" data-type="search" placeholder="Enter class...">
				</form>
				<ul id="autocomplete" data-role="listview" data-filter="true" data-input="#autocomplete-input" data-theme="a" data-inset="true" ></ul>
			</div> <!-- /content -->
			<!-- <div data-role="footer" data-theme="a" data-position="fixed">
				<h4>footer</h4>
			</div> --> <!-- /footer -->
		</div> <!-- /page -->

		<!-- UNCOMMENT THE FOLLOWING LINE WHEN INSTALLING ON A DEVICE!!!!! -->
		<script type="text/javascript" src="cordova.js"></script>
		<script type="text/javascript" src="js/index.js"></script>
		<script type="text/javascript" charset="utf-8" src="PushNotification.js"></script>
		<script>
			app.initialize(app.registerUser);
			$( document ).on( "pagebeforeshow", "#index", function() {
				$("#autocomplete").on("filterablebeforefilter", function(e, data ) {
					var pickedlistsearch = JSON.parse(localStorage.getItem("picked"));
					var classArray = [];
					var $ul = $(this),
						$input = $(data.input),
						value = $input.val(),
						html = "";
					$ul.html("");
					if(value && value.length > 2) {
						$.mobile.loading("show");
						var i = 1;
						for(var department in json){
							for(var clas in json[department]){
								for(var section in json[department][clas]){
									classArray.push(clas + "." + section + "," + department + "," + clas + "," + section);
								}
							}
						}
						classArray.sort();
						var x = classArray.length;
						for (var i = 0; i < x; i++) {
							var info = classArray[i].split(",");
							var name = info[0];
							var depArr = info[1];
							var clArr = info[2];
							var secArr = info[3];
							var clsQuote = '"' + clArr + '"';
							var deptQuote = '"' + depArr + '"';
							var sectQuote = '"' + secArr + '"';
							var classname = json[depArr][clArr][secArr]["name"];
							var deptname = json[depArr][clArr][secArr]["department"];
							var sectname = json[depArr][clArr][secArr]["section"];
							var deptnamestring = String(deptname).toUpperCase();
							var sectnamestring = String(sectname).toUpperCase();
							var classstring = String(classname).toUpperCase();
							var deptstring = String(department).toUpperCase();
							var valueupper = value.toUpperCase();
							if((classstring.indexOf(valueupper) >= 0) || (deptstring.indexOf(valueupper) >= 0) || (deptnamestring.indexOf(valueupper) >= 0) || (sectnamestring.indexOf(valueupper) >= 0)) {
								if ((typeof pickedlistsearch[depArr]) == 'undefined') {
									if(json[depArr][clArr][secArr]["status"] == "Closed") {
										html += "<li id ='listitem"+i+"' data-filtertext='" + depArr + " " + classname + " " + deptname + " " + sectname + "' style='background-color:#f06d6d;margin-top:10px;'><h2>" + name + "</h2><p class='nameleft'>"+json[depArr][clArr][secArr]["name"]+"</p><p class='profright'>"+json[depArr][clArr][secArr]["professor"]+"</p><p class='timesleft'>"+json[depArr][clArr][secArr]["meeting"]+"</p><p class='roomright'>"+json[depArr][clArr][secArr]["room"]+"</p><span class='flipperSearch'><select id='flip2' data-role='slider' data-mini='true' data-theme='c' onchange='flipperChange("+deptQuote+","+clsQuote+","+sectQuote+",this.value)'><option value='off'></option><option value='on'></option></select></span></li>";
										i++;
									} else {
										html += "<li id ='listitem"+i+"' data-filtertext='" + depArr + " " + classname + " " + deptname + " " + sectname + "' style='background-color:#b9cf96;margin-top:10px;'><h2>" + name + "</h2><p class='nameleft'>"+json[depArr][clArr][secArr]["name"]+"</p><p class='profright'>"+json[depArr][clArr][secArr]["professor"]+"</p><p class='timesleft'>"+json[depArr][clArr][secArr]["meeting"]+"</p><p class='roomright'>"+json[depArr][clArr][secArr]["room"]+"</p><span class='flipperSearch'><select id='flip2' data-role='slider' data-mini='true' data-theme='c' onchange='flipperChange("+deptQuote+","+clsQuote+","+sectQuote+",this.value)'><option value='off'></option><option value='on'></option></select></span></li>";
										i++;
									}
								} else if ((typeof pickedlistsearch[depArr][clArr]) == 'undefined') {
									if(json[depArr][clArr][secArr]["status"] == "Closed") {
										html += "<li id ='listitem"+i+"' data-filtertext='" + depArr + " " + classname + " " + deptname + " " + sectname + "' style='background-color:#f06d6d;margin-top:10px;'><h2>" + name + "</h2><p class='nameleft'>"+json[depArr][clArr][secArr]["name"]+"</p><p class='profright'>"+json[depArr][clArr][secArr]["professor"]+"</p><p class='timesleft'>"+json[depArr][clArr][secArr]["meeting"]+"</p><p class='roomright'>"+json[depArr][clArr][secArr]["room"]+"</p><span class='flipperSearch'><select id='flip2' data-role='slider' data-mini='true' data-theme='c' onchange='flipperChange("+deptQuote+","+clsQuote+","+sectQuote+",this.value)'><option value='off'></option><option value='on'></option></select></span></li>";
										i++;
									} else {
										html += "<li id ='listitem"+i+"' data-filtertext='" + depArr + " " + classname + " " + deptname + " " + sectname + "' style='background-color:#b9cf96;margin-top:10px;'><h2>" + name + "</h2><p class='nameleft'>"+json[depArr][clArr][secArr]["name"]+"</p><p class='profright'>"+json[depArr][clArr][secArr]["professor"]+"</p><p class='timesleft'>"+json[depArr][clArr][secArr]["meeting"]+"</p><p class='roomright'>"+json[depArr][clArr][secArr]["room"]+"</p><span class='flipperSearch'><select id='flip2' data-role='slider' data-mini='true' data-theme='c' onchange='flipperChange("+deptQuote+","+clsQuote+","+sectQuote+",this.value)'><option value='off'></option><option value='on'></option></select></span></li>";
										i++;
									}
								} else if ((typeof pickedlistsearch[depArr][clArr][secArr]) == 'undefined') {
									if(json[depArr][clArr][secArr]["status"] == "Closed") {
										html += "<li id ='listitem"+i+"' data-filtertext='" + depArr + " " + classname + " " + deptname + " " + sectname + "' style='background-color:#f06d6d;margin-top:10px;'><h2>" + name + "</h2><p class='nameleft'>"+json[depArr][clArr][secArr]["name"]+"</p><p class='profright'>"+json[depArr][clArr][secArr]["professor"]+"</p><p class='timesleft'>"+json[depArr][clArr][secArr]["meeting"]+"</p><p class='roomright'>"+json[depArr][clArr][secArr]["room"]+"</p><span class='flipperSearch'><select id='flip2' data-role='slider' data-mini='true' data-theme='c' onchange='flipperChange("+deptQuote+","+clsQuote+","+sectQuote+",this.value)'><option value='off'></option><option value='on'></option></select></span></li>";
										i++;
									} else {
										html += "<li id ='listitem"+i+"' data-filtertext='" + depArr + " " + classname + " " + deptname + " " + sectname + "' style='background-color:#b9cf96;margin-top:10px;'><h2>" + name + "</h2><p class='nameleft'>"+json[depArr][clArr][secArr]["name"]+"</p><p class='profright'>"+json[depArr][clArr][secArr]["professor"]+"</p><p class='timesleft'>"+json[depArr][clArr][secArr]["meeting"]+"</p><p class='roomright'>"+json[depArr][clArr][secArr]["room"]+"</p><span class='flipperSearch'><select id='flip2' data-role='slider' data-mini='true' data-theme='c' onchange='flipperChange("+deptQuote+","+clsQuote+","+sectQuote+",this.value)'><option value='off'></option><option value='on'></option></select></span></li>";
										i++;
									}
								} else {
									if(json[depArr][clArr][secArr]["status"] == "Closed") {
										html += "<li id ='listitem"+i+"' data-filtertext='" + depArr + " " + classname + " " + deptname + " " + sectname + "' style='background-color:#f06d6d;margin-top:10px;'><h2>" + name + "</h2><p class='nameleft'>"+json[depArr][clArr][secArr]["name"]+"</p><p class='profright'>"+json[depArr][clArr][secArr]["professor"]+"</p><p class='timesleft'>"+json[depArr][clArr][secArr]["meeting"]+"</p><p class='roomright'>"+json[depArr][clArr][secArr]["room"]+"</p><span class='flipperSearch'><select id='flip2' data-role='slider' data-mini='true' data-theme='c' onchange='flipperChange("+deptQuote+","+clsQuote+","+sectQuote+",this.value)'><option value='off'></option><option value='on' selected=''></option></select></span></li>";
										i++;
									} else {
										html += "<li id ='listitem"+i+"' data-filtertext='" + depArr + " " + classname + " " + deptname + " " + sectname + "' style='background-color:#b9cf96;margin-top:10px;'><h2>" + name + "</h2><p class='nameleft'>"+json[depArr][clArr][secArr]["name"]+"</p><p class='profright'>"+json[depArr][clArr][secArr]["professor"]+"</p><p class='timesleft'>"+json[depArr][clArr][secArr]["meeting"]+"</p><p class='roomright'>"+json[depArr][clArr][secArr]["room"]+"</p><span class='flipperSearch'><select id='flip2' data-role='slider' data-mini='true' data-theme='c' onchange='flipperChange("+deptQuote+","+clsQuote+","+sectQuote+",this.value)'><option value='off'></option><option value='on' selected=''></option></select></span></li>";
										i++;
									}
								}
								$.mobile.loading("hide");
							}
						}
						if(html == "") {
							html = "<li>No results for "+value+".</li>";
							$.mobile.loading("hide");
						}
						$ul.html(html);
						$ul.listview("refresh");
						$ul.trigger("updatelayout");
						$ul.trigger('create');
					}
				});
			});
		</script>
	</body>
</html>