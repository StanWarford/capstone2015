<!DOCTYPE html>
<html>
	<head>
		<title>Page Title</title>
		<meta name = "viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="css/one.css" />
		<link rel="stylesheet" href="css/index.css" />
		<script src="jquery-1.11.2.min.js"></script>
		<script src="js/a.js"></script>
		<script src="js/b.js"></script>
		<link rel="stylesheet" href="css/peptheme.css">
		<link rel='stylesheet' href='fullcalendar/fullcalendar.css' />
		<script src='fullcalendar/moment.min.js'></script>
		<script src="js/global.js"></script>
		<script src='fullcalendar/fullcalendar.js'></script>
		<!--Following initialized the calendar and sets it to screen size-->
		<script>
			var myHeight = $( window ).height();
			$(document).click(function() {
				$('#calendar').fullCalendar({
					height: myHeight,
				    defaultView: 'agendaWeek',
				    weekends: false,
				    defaultDate:'2015-08-31', //manually sets calendar to start on first day of semester
					events: cEvents(), //calls function cEvents() from global.js
					allDaySlot: false,
					minTime: "07:00:00",
					maxTime: "23:00:00",
					header: false,
					slotEventOverlap : false,
					});
			});
		</script>
	</head>
	<body>
		<div data-role="page" data-theme="a" id="index">
			<div data-role="panel" id="mypanel">
				<ul data-role="listview" data-inset="true" style="min-width:210px;">
					<li><a href="search.html" class="ui-icon-search" data-ajax="false">Search</a></li>
					<li><a href="browse.html" class="ui-icon-grid" data-ajax="false">Browse</a></li>
					<li><a href="options.html" class="ui-icon-gear" data-ajax="false">Options</a></li>
					<li><a href="index.html" data-ajax="false">Temp: Splash</a></li>
					<li><a href="first.html" data-ajax="false">Temp: First</a></li>
				</ul>
				<a href="#my-header" data-rel="close" class="ui-btn ui-corner-all ui-shadow ui-icon-delete ui-btn-icon-right ui-btn-a">Close panel</a>
			</div><!-- /panel -->
			<div data-role="header" id="my-header" data-theme="a" data-position="fixed">
				<a href="#mypanel" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-icon-bars ui-btn-icon-left ui-btn-a menu">menu</a>
				<img src="images/buoy-white.gif" alt="Buoy" style="height:50px;display:block;margin-left:auto;margin-right:auto;margin-bottom:4px;" />
				<a href="home.html" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-icon-home ui-btn-icon-right ui-btn-a menu" data-ajax="false">home</a>
			</div> <!-- /header --><!--header and panel identical on home, search, browse, options, and help pages-->
			<div data-role="content">
				<div data-role="tabs" id="tabs" style:"padding-bottom = 10px">
					<div data-role="navbar">
    					<ul>
      						<li><a href="#list" data-ajax="false" class="ui-btn-active">list</a></li> <!--Makes list button active when page opens-->
      						<li><a href="#calView" data-ajax="false">calendar</a></li>
    					</ul>
 					</div> <!--/navbar-->
 					<div id="list">
 						<ul data-role="listview" data-inset="true" id="classespicked"></ul>
 					</div>
 					<div id="calView" style="width:100%; overflow-x:scroll; margin-top:15px;">
 						(Scrolls with two fingers on iOS) <!--Warning for users who are not aware of this functionality-->
 						<div id="calendar" style = "background-color: #f6f6f6; min-width:550px;"></div>
 					</div>
				</div>
			</div> <!-- /content -->
		</div> <!-- /page -->
		<script type="text/javascript">
			$( document ).on( "pagebeforeshow", "#index", function() {
				var plhome = JSON.parse(localStorage.getItem("picked")); //pull list of followed classes on localStorage
				var i = 1;
				for (var dept in plhome) {
					for (var classes in plhome[dept]) {
						for (var section in plhome[dept][classes]) { //read every section followed
							if ((typeof json[dept]) != 'undefined') {
								if ((typeof json[dept][classes]) != 'undefined') {
									if ((typeof json[dept][classes][section]) != 'undefined') { //make sure that section still exits in server
										var clsQuote = '"' + classes + '"';
										var deptQuote = '"' + dept +'"';
										var sectQuote = '"' + section + '"'; //add quotes for text added as function parameter
										$('#classespicked').append('<li class="ui-field-contain" id="pickitem'+i+'"></li>'); //outer list item for first section
										$('#pickitem'+i).css('background-color','#b9cf96'); //set color to green
										if(json[dept][classes][section]["status"] == "Closed") {
											$('#pickitem'+i).css('background-color','#f06d6d'); //set closed section color to red
										}
										$('#pickitem'+i).css('margin-top','10px'); //margin between classes
										$('#pickitem'+i).append('<h2 id="pickwords'+i+'"></h2>'); //add section title tag to list item
										$('#pickitem'+i).append('<p id="pickname'+i+'" class="nameleft"></p>'); //add section name tag to list item
										$('#pickname'+i).css('font-size','14px');
										$('#pickitem'+i).append('<p id="pickprof'+i+'" class="profright"></p>'); //add section professor tag to list item
										$('#pickprof'+i).css('font-size','14px');
										$('#pickitem'+i).append('<p id="pickother'+i+'" class="timesleft"></p>'); //add section times tag to list item
										$('#pickother'+i).css('font-size','14px');
										$('#pickitem'+i).append('<p id="pickroom'+i+'" class="roomright"></p>');//add section room tag to list item
										$('#pickroom'+i).css('font-size','14px'); //change size of sub-header information
										$('#pickwords'+i).append(classes+"."+section); //add section title
										$('#pickprof'+i).append(plhome[dept][classes][section]["professor"]); //add professor's name
										$('#pickname'+i).append(plhome[dept][classes][section]["name"]); //add section name
										$('#pickother'+i).append(plhome[dept][classes][section]["meeting"]); //add times
										$('#pickroom'+i).append(plhome[dept][classes][section]["room"]); // add room
										$('#pickitem'+i).append("<span class='flipperBrowse'><select id='flip"+i+"' data-role='slider' data-mini='true' data-theme='c' onchange='flipperChange("+deptQuote+","+clsQuote+","+sectQuote+",this.value)'><option value='off'></option><option value='on' selected=''></option></select></span>"); //add flipper to list item. Theme 'c' to change color. Flipper default is on as classes are followed. Adds flipperChange() function to onchange for unfollowing classes.
										$('#index').trigger('create'); //update page to take data
										$("#classespicked").listview("refresh"); //update css of list
										i++;
									}
								}
							}
						}
					} 
				}
			});
		</script>
	</body>
</html>
<!-- UNCOMMENT THE FOLLOWING LINE WHEN INSTALLING ON A DEVICE!!!!! -->
<script type="text/javascript" src="cordova.js"></script>
<script type="text/javascript" src="js/index.js"></script>
<script type="text/javascript" charset="utf-8" src="PushNotification.js"></script>
<script type="text/javascript">
	app.initialize(app.registerUser);
</script>